


think hard 仔细学习./nanochat/models/ebt/modeling_ebt.py中对于EBT_NLP的定义，理解这其中的逻辑。用./nanochat/gpt.py的方式重新定义这个模型在./nanochat/ebt.py中。注意./nanochat/ebt.py的核心逻辑遵循./nanochat/models/ebt/modeling_ebt.py中的定义，但是代码实现方式遵循./nanochat/gpt.py。我已经为你创建了./nanochat/ebt.py，你将Class定义在其中就行了，你可以定义任意你需要的辅助函数或者Class。

你是资深Python工程师，用纯Pytorch的方式实现以下类或者函数，注释用英文：

pytorch_lightning.Trainer
pytorch_lightning.LightningModule
pytorch_lightning.strategies.DDPStrategy,
pytorch_lightning.seed_everything,
pytorch_lightning.utilities.rank_zero.rank_zero_only,
pytorch_lightning.loggers.WandbLogger,
pytorch_lightning.callbacks.ModelCheckpoint, 
pytorch_lightning.callbacks.ModelSummary



Reimplement the following class and functions using pure Pytorch, with English comments:

pytorch_lightning.strategies.DDPStrategy,
pytorch_lightning.seed_everything,
pytorch_lightning.utilities.rank_zero.rank_zero_only,
pytorch_lightning.loggers.WandbLogger,
pytorch_lightning.callbacks.ModelCheckpoint,

Write all implementations into: './claude_class/torchlightning_function.py'.

Verify the implementation of claude_class.torchlightning_trainer.ModelSummary

---------

Reimplement the pytorch_lightning.Trainer class using pure Pytorch, with English comments.
Write your implementations into: './claude_class/torchlightning_trainer.py'.
You can define any auxiliary functions or classes you need.

https://lightning.ai/docs/pytorch/stable/api/lightning.pytorch.core.LightningModule.html

根据torchlighting.LightningModule的官方定义，用纯Pytorch的方式实现LightningModule类，注释用英文：


https://lightning.ai/docs/pytorch/stable/api/lightning.pytorch.trainer.trainer.Trainer.html

根据pytorch_lightning.Trainer的官方定义，用纯Pytorch的方式实现Trainer类，注释用英文：

https://lightning.ai/docs/pytorch/stable/api/lightning.pytorch.strategies.DDPStrategy.html

根据pytorch_lightning.DDPStrategy的官方定义，用纯Pytorch的方式实现DDPStrategy类，注释用英文：

https://pytorch-lightning.readthedocs.io/en/1.7.7/api/pytorch_lightning.utilities.seed.html#pytorch_lightning.utilities.seed.seed_everything

根据 pytorch_lightning.utilities.seed.seed_everything 的官方注释，用纯Pytorch的方式实现 seed_everything 函数，注释用英文：


https://pytorch-lightning.readthedocs.io/en/1.4.9/extensions/generated/pytorch_lightning.loggers.WandbLogger.html

根据 pytorch_lightning.loggers.WandbLogger 的官方注释，用纯Pytorch的方式实现 WandbLogger 类，注释用英文：

https://pytorch-lightning.readthedocs.io/en/1.7.7/api/pytorch_lightning.utilities.rank_zero.html#pytorch_lightning.utilities.rank_zero.rank_zero_only

根据 pytorch_lightning.utilities.rank_zero.rank_zero_only 的官方注释，用纯Pytorch的方式实现 rank_zero_only 函数，注释用英文：

https://lightning.ai/docs/pytorch/stable/api/lightning.pytorch.callbacks.ModelSummary.html

根据 ppytorch_lightning.callbacks.ModelSummary 的官方注释，用纯Pytorch的方式实现 ModelSummary 类，注释用英文：

https://lightning.ai/docs/pytorch/stable/extensions/callbacks.html  
https://lightning.ai/docs/pytorch/stable/api/lightning.pytorch.callbacks.ModelCheckpoint.html

根据 pytorch_lightning.callbacks.Callback 和 pytorch_lightning.callbacks.ModelCheckpoint 的官方注释，用纯Pytorch的方式实现 Callback 和 ModelCheckpoint 类，ModelCheckpoint 要继承 Callback 类，注释用英文：